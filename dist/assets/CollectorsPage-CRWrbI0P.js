import{g as I,j as s,t as l,d as v}from"./index-CauVn42D.js";import{r as d}from"./vendor-charts-mg27ZyhM.js";import{l as p,n as g}from"./vendor-firebase-e-MEdNrP.js";import"./vendor-react-Bzgz95E1.js";function L({onBackToHome:n}){const[o,b]=d.useState([]),[f,h]=d.useState(!0),[u,x]=d.useState(null),e=I();d.useEffect(()=>{(async()=>{h(!0),x(null);try{const c=p(v,"users"),y=await g(c),C=p(v,"cards"),k=await g(C),i={};k.docs.forEach(r=>{const a=r.data();a.userId&&a.status==="zbierka"&&(i[a.userId]||(i[a.userId]={count:0,totalValue:0,withImages:0}),i[a.userId].count++,i[a.userId].totalValue+=a.current||0,a.imageUrl&&i[a.userId].withImages++)});const N=y.docs.map(r=>{const a=r.data(),m=i[r.id]||{count:0,totalValue:0,withImages:0};return{id:r.id,displayName:a.displayName||"Anonym",photoURL:a.photoURL||null,email:a.email||"",itemCount:m.count,totalValue:m.totalValue,withImages:m.withImages,createdAt:a.createdAt||null}}).filter(r=>r.itemCount>0).sort((r,a)=>a.totalValue-r.totalValue);console.log("Collectors loaded:",N.length),b(N)}catch(c){console.error("Error loading collectors:",c),x(l("collectors.error",e))}finally{h(!1)}})()},[]);const j=t=>t==null?"‚Ç¨0":new Intl.NumberFormat("sk-SK",{style:"currency",currency:"EUR",minimumFractionDigits:0,maximumFractionDigits:0}).format(t);return f?s.jsxs("div",{className:"collectors-page",children:[s.jsxs("div",{className:"collectors-header",children:[s.jsx("button",{onClick:n,className:"back-button",children:l("collectors.back",e)}),s.jsxs("h1",{children:["üéØ ",l("collectors.title",e)]})]}),s.jsxs("div",{className:"loading-container",children:[s.jsx("div",{className:"spinner"}),s.jsx("p",{children:l("collectors.loading",e)})]})]}):u?s.jsxs("div",{className:"collectors-page",children:[s.jsxs("div",{className:"collectors-header",children:[s.jsx("button",{onClick:n,className:"back-button",children:l("collectors.back",e)}),s.jsxs("h1",{children:["üéØ ",l("collectors.title",e)]})]}),s.jsx("div",{className:"error-container",children:s.jsxs("p",{className:"error-text",children:["‚ùå ",u]})})]}):o.length===0?s.jsxs("div",{className:"collectors-page",children:[s.jsxs("div",{className:"collectors-header",children:[s.jsx("button",{onClick:n,className:"back-button",children:l("collectors.back",e)}),s.jsxs("h1",{children:["üéØ ",l("collectors.title",e)]})]}),s.jsxs("div",{className:"empty-container",children:[s.jsx("div",{className:"empty-icon",children:"üéØ"}),s.jsx("p",{className:"empty-text",children:l("collectors.empty",e)}),s.jsx("p",{className:"empty-subtext",children:l("collectors.empty.cta",e)})]})]}):s.jsxs("div",{className:"collectors-page",children:[s.jsxs("div",{className:"collectors-header",children:[s.jsx("button",{onClick:n,className:"back-button",children:l("collectors.back",e)}),s.jsxs("h1",{children:["üéØ ",l("collectors.title",e)]}),s.jsxs("p",{className:"collectors-subtitle",children:[l("collectors.subtitle",e)," ‚Ä¢ ",e==="en"?"Total":e==="cz"?"Celkem":"Celkom"," ",o.length," ",l("collectors.count",e)]})]}),s.jsxs("div",{className:"collectors-stats",children:[s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-value",children:o.reduce((t,c)=>t+c.itemCount,0)}),s.jsx("div",{className:"stat-label",children:l("collectors.stats.total",e)})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-value",children:j(o.reduce((t,c)=>t+c.totalValue,0))}),s.jsx("div",{className:"stat-label",children:l("collectors.stats.value",e)})]}),s.jsxs("div",{className:"stat-card",children:[s.jsx("div",{className:"stat-value",children:o.length}),s.jsx("div",{className:"stat-label",children:l("collectors.stats.active",e)})]})]}),s.jsx("div",{className:"collectors-list",children:o.map((t,c)=>s.jsxs("div",{className:"collector-card",children:[s.jsxs("div",{className:"collector-rank",children:["#",c+1]}),s.jsx("div",{className:"collector-avatar",children:t.photoURL?s.jsx("img",{src:t.photoURL,alt:t.displayName}):s.jsx("div",{className:"avatar-placeholder",children:t.displayName.charAt(0).toUpperCase()})}),s.jsxs("div",{className:"collector-info",children:[s.jsx("h3",{className:"collector-name",children:t.displayName}),s.jsxs("div",{className:"collector-stats-row",children:[s.jsxs("span",{className:"stat-item",children:["üì¶ ",t.itemCount," ",l("collectors.items",e)]}),t.withImages>0&&s.jsxs("span",{className:"stat-item",children:["üì∏ ",t.withImages," ",l("collectors.photos",e)]})]})]}),s.jsxs("div",{className:"collector-value",children:[s.jsx("div",{className:"value-label",children:l("collectors.value",e)}),s.jsx("div",{className:"value-amount",children:j(t.totalValue)})]})]},t.id))}),s.jsx("div",{className:"donate-section",children:s.jsxs("div",{className:"donate-content",children:[s.jsx("div",{className:"donate-icon",children:"üíù"}),s.jsx("h2",{className:"donate-title",children:l("collectors.donate.title",e)}),s.jsx("p",{className:"donate-text",children:l("collectors.donate.text",e)}),s.jsxs("a",{href:"https://paypal.me/murino821",target:"_blank",rel:"noopener noreferrer",className:"donate-button",children:[s.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M20.067 8.478c.492.88.556 2.014.3 3.327-.74 3.806-3.276 5.12-6.514 5.12h-.5a.805.805 0 00-.794.68l-.04.22-.63 3.993-.028.15a.806.806 0 01-.795.68H7.723c-.3 0-.544-.24-.505-.54l.015-.087.81-5.143c.048-.306.295-.54.605-.54h1.334c2.731 0 4.867-.989 5.514-3.851.295-1.305.11-2.387-.555-3.217-.203-.254-.45-.478-.737-.671.18-.036.368-.058.563-.058h.5c1.653 0 3.042.388 3.901 1.318zm-3.567-6.478c.84 0 1.538.298 2.07.861.562.594.818 1.468.76 2.596-.006.13-.014.263-.024.399l-.051.664c-.049.634-.194 1.155-.437 1.562-.242.407-.635.729-1.175.96-.51.218-1.147.327-1.898.327h-.5c-.37 0-.697.267-.772.63l-.022.12-.86 5.448-.028.151c-.048.255-.272.453-.531.453H9.677c-.3 0-.544-.24-.505-.54l.015-.087.81-5.143c.048-.306.295-.54.605-.54h1.334c2.731 0 4.867-.989 5.514-3.851.273-1.208.125-2.216-.395-3.006-.277-.42-.643-.757-1.09-1.004H16.5z"})}),l("collectors.donate.button",e)]}),s.jsx("p",{className:"donate-note",children:l("collectors.donate.note",e)})]})})]})}export{L as default};
